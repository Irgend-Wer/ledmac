
\renewcommand*{\beginnumbering}{%
  \ifnumbering
    \led@err@NumberingStarted
    \endnumbering
  \fi
  \global\numberingtrue
  \global\advance\section@num \@ne
  \initnumbering@reg
  \message{Section \the\section@num }%
  \line@list@stuff{\jobname.\extensionchars\the\section@num}%
  \l@dend@stuff
  \setcounter{pstart}{1}
  \ifl@dpairing
      \global\l@dnumpstartsL \z@
      \global\pst@rtedLfalse
  \else
    \begingroup
  \fi
  \initnumbering@sectcmd
  \gdef\eled@sections@@{}
  \InputIfFileExists{\jobname.eledsec\the\section@num}{}{}
  \immediate\openout\eled@sectionning@out=\jobname.eledsec\the\section@num\relax
}

\def\endnumbering{%
  \ifnumbering
    \global\numberingfalse
    \normal@pars
    \ifl@dpairing
      \global\pst@rtedLfalse
    \else
      \ifx\insertlines@list\empty\else
        \global\noteschanged@true
      \fi
      \ifx\line@list\empty\else
        \global\noteschanged@true
      \fi
    \fi
    \ifnoteschanged@
      \led@mess@NotesChanged
    \fi
  \else
    \led@err@NumberingNotStarted
  \fi
  \autoparfalse
  \immediate\closeout\eled@sectionning@out
  \ifl@dpairing\else
    \endgroup
  \fi
}

\renewcommand*{\pstart}{%
  \global\advance\l@dnumpstartsL \@ne
  \if@nobreak%
    \let\@oldnobreak\@nobreaktrue%
  \else%
    \let\@oldnobreak\@nobreakfalse%
  \fi%
  \@nobreaktrue%
  \ifnumbering \else%
    \led@err@PstartNotNumbered%
    \beginnumbering%
  \fi%
  \ifnumberedpar@%
    \led@err@PstartInPstart%
    \pend%
  \fi%
  \list@clear{\inserts@list}%
  \global\let\next@insert=\empty%
  \begingroup\normal@pars%
  \global\setbox\raw@text=\vbox\bgroup%
    \ifautopar\else%
    \ifnumberpstart%
      \ifinstanza\else%
       \ifsidepstartnum\else%
         \thepstart%
        \fi%
       \fi%
      \fi%
     \fi%
  \numberedpar@true%
  \iflabelpstart%
    \protected@edef\@currentlabel%
       {\p@pstart\thepstart}
  \fi%
}

 \renewcommand*{\do@line}{%
  {\vbadness=10000
   \splittopskip=\z@
   \do@linehook
\l@demptyd@ta
   \global\setbox\one@line=\vsplit\raw@text to\baselineskip}%
  \unvbox\one@line \global\setbox\one@line=\lastbox
  \getline@num
  \IfStrEq{\led@pb@setting}{before}{\led@check@pb\led@check@nopb}{}
  \ifnum\@lock>\@ne
    \inserthangingsymboltrue
  \else
    \inserthangingsymbolfalse
  \fi
  \check@pb@in@verse
  \affixline@num
  \affixpstart@num
  \add@inserts\affixside@note
  \xifinlist{\the\l@dnumpstartsL}{\eled@sections@@}%
     {\print@ledsection}%
     {\print@line}%
  \IfStrEq{\led@pb@setting}{after}{\led@check@pb\led@check@nopb}{}
  }%
\def\print@line{
	\hb@xt@ \linewidth{\do@insidelinehook\l@dld@ta
	    \l@dlsn@te
	    {\ledllfill\hb@xt@ \wd\one@line{\new@line\inserthangingsymbol \l@dunhbox@line{\one@line}}\ledrlfill\l@drd@ta%
	    \l@drsn@te
	  }}%
}

\def\print@ledsection{%
    \numdef{\temp@}{\l@dnumpstartsL-1}%
    \xifinlist{\temp@}{\eled@sections@@}{\@nobreaktrue}{\@nobreakfalse}%
    \csuse{eled@sectionning@\the\l@dnumpstartsL}\hspace{\paperwidth}{\new@line \l@dunhbox@line{\one@line}}%
    \vskip-\baselineskip%
}
